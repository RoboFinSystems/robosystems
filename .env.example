## =============================================================================
## ROBOSYSTEMS ENVIRONMENT CONFIGURATION
## =============================================================================
##
## This is the template environment configuration file with example values.
##
## IMPORTANT: This file is committed to git and contains placeholders/examples.
## - Copy this file to .env to create your active configuration
## - Docker Compose services use container hostnames (pg, valkey, graph-api, etc.)
## - For local development overrides, create .env.local from .env.local.example
##
## SETUP: Copy this file during initial setup
##   cp .env.example .env
##
## The .env file is gitignored and should contain your actual configuration values.
##
## =============================================================================

## =============================================================================
## CORE APPLICATION CONFIGURATION
## =============================================================================

## Environment settings
ENVIRONMENT=dev
LOG_LEVEL=INFO
# DEBUG=false
# HOST=0.0.0.0
# PORT=8000

## Encryption Keys
CONNECTION_CREDENTIALS_KEY=your-random-32-byte-connection-key-here
GRAPH_BACKUP_ENCRYPTION_KEY=your-backup-encryption-key-here
JWT_SECRET_KEY=your-random-32-byte-jwt-secret-key-here
ADMIN_API_KEY=dev-admin-key-for-testing-only

## Service URLs
ROBOSYSTEMS_API_URL=http://localhost:8000
ROBOSYSTEMS_URL=http://localhost:3000
ROBOLEDGER_URL=http://localhost:3001
ROBOINVESTOR_URL=http://localhost:3002

## JWT Token Configuration (Authentication)
# JWT_ISSUER=api.robosystems.ai
# JWT_AUDIENCE=robosystems.ai,roboledger.ai,roboinvestor.ai
# JWT_EXPIRY_HOURS=0.5
# TOKEN_GRACE_PERIOD_MINUTES=5

## Authentication Rate Limiting
# JWT_REFRESH_RATE_LIMIT=20
# AUTH_RATE_LIMIT_LOGIN=5
# AUTH_RATE_LIMIT_REGISTER=3

## Email Configuration
# EMAIL_FROM_ADDRESS=noreply@robosystems.ai
# EMAIL_FROM_NAME=RoboSystems
# EMAIL_TOKEN_EXPIRY_HOURS=24
# PASSWORD_RESET_TOKEN_EXPIRY_HOURS=1

## =============================================================================
## FEATURE FLAGS
## =============================================================================

## Core Application Features
USER_REGISTRATION_ENABLED=true
BILLING_ENABLED=false
RATE_LIMIT_ENABLED=false
SSE_ENABLED=true
OTEL_ENABLED=false
LOAD_SHEDDING_ENABLED=false

## Organization Graph Features
ORG_GRAPHS_DEFAULT_LIMIT=100
ORG_MEMBER_INVITATIONS_ENABLED=false

## Dagster Schedule Features
BILLING_SCHEDULES_ENABLED=false
INSTANCE_SCHEDULES_ENABLED=false
SEC_SCHEDULES_ENABLED=false
SHARED_REPO_SCHEDULE_ENABLED=false

## Security and Authentication Features
SECURITY_AUDIT_ENABLED=false
CSP_TRUSTED_TYPES_ENABLED=true
EMAIL_VERIFICATION_ENABLED=false
CAPTCHA_ENABLED=false
CORS_ALLOW_CREDENTIALS=true

## Graph Operations Features
SUBGRAPH_CREATION_ENABLED=true
BACKUP_CREATION_ENABLED=true
AGENT_POST_ENABLED=true

## Graph Infrastructure Features (applies to all backends)
GRAPH_CIRCUIT_BREAKERS_ENABLED=true
GRAPH_REDIS_CACHE_ENABLED=true
GRAPH_RETRY_LOGIC_ENABLED=true
GRAPH_HEALTH_CHECKS_ENABLED=true
SHARED_MASTER_READS_ENABLED=true

## Connection Provider Features
CONNECTION_SEC_ENABLED=false
CONNECTION_QUICKBOOKS_ENABLED=false
CONNECTION_PLAID_ENABLED=false


## =============================================================================
## GRAPH DATABASES - MULTI-BACKEND
## =============================================================================

## =============================================================================
## GRAPH API CONFIGURATION (Backend-Agnostic)
## =============================================================================
## Configuration that applies to all graph database backends (LadybugDB, Neo4j)

## Graph Backend Selection
## Options: ladybug, neo4j_community, neo4j_enterprise
GRAPH_BACKEND_TYPE=ladybug

## Graph API Endpoint
GRAPH_API_URL=http://graph-api:8001
# GRAPH_API_KEY=your-graph-api-key-here

## Shared Repository Backend (dev/local only)
# Override which backend to use for shared repositories (SEC, etc.) in development
# In AWS environments, this is determined by graph.yml tier configuration
# Options: ladybug or neo4j
GRAPH_SHARED_REPOSITORY_BACKEND=ladybug

## Graph Database Backups (S3)
# GRAPH_DATABASES_BUCKET=robosystems-graph-databases-dev

## Graph Registry Tables (DynamoDB)
# GRAPH_REGISTRY_TABLE=robosystems-graph-dev-graph-registry
# INSTANCE_REGISTRY_TABLE=robosystems-graph-dev-instance-registry
# VOLUME_REGISTRY_TABLE=robosystems-graph-dev-volume-registry

## Graph Instance Metadata (EC2)
# INSTANCE_ID=unknown
# CLUSTER_TIER=standard

## Graph API Timeouts and Limits (applies to all backends)
# GRAPH_HTTP_TIMEOUT=30
# GRAPH_QUERY_TIMEOUT=30
# GRAPH_MAX_QUERY_LENGTH=50000
# GRAPH_MAX_REQUEST_SIZE=10485760
# GRAPH_CONNECT_TIMEOUT=5.0
# GRAPH_READ_TIMEOUT=30.0

## Graph Resiliency Configuration (applies to all backends)
# GRAPH_CIRCUIT_BREAKER_THRESHOLD=5
# GRAPH_CIRCUIT_BREAKER_TIMEOUT=60
# GRAPH_INSTANCE_CACHE_TTL=3600
# GRAPH_HEALTH_CHECK_INTERVAL_MINUTES=5.0

## Tier-Specific Memory and Performance Overrides (Optional)
## Override the default tier settings from constants.py
## Tiers: ladybug-standard, ladybug-large, ladybug-xlarge
# GRAPH_STANDARD_MAX_MEMORY_MB=14336
# GRAPH_LARGE_MAX_MEMORY_MB=14336
# GRAPH_XLARGE_MAX_MEMORY_MB=28672
# GRAPH_STANDARD_MEMORY_PER_DB_MB=2048
# GRAPH_LARGE_MEMORY_PER_DB_MB=14336
# GRAPH_XLARGE_MEMORY_PER_DB_MB=28672
# GRAPH_STANDARD_CHUNK_SIZE=1000
# GRAPH_LARGE_CHUNK_SIZE=5000
# GRAPH_XLARGE_CHUNK_SIZE=10000

## =============================================================================
## BACKEND-SPECIFIC CONFIGURATION
## =============================================================================

## =============================================================================
## LADYBUGDB-SPECIFIC CONFIGURATION (when GRAPH_BACKEND_TYPE=ladybug)
## =============================================================================

## LadybugDB Database Configuration
LBUG_DATABASE_PATH=./data/ladybug-dbs
DUCKDB_STAGING_PATH=./data/staging
LBUG_ACCESS_PATTERN=api_auto
LBUG_NODE_TYPE=writer

## LadybugDB Capacity
LBUG_MAX_DATABASES_PER_NODE=50

## LadybugDB Memory Configuration
# LBUG_MAX_MEMORY_MB=2048
# LBUG_MAX_MEMORY_PER_DB_MB=0

## LadybugDB Connection Management
# LBUG_MAX_CONNECTIONS_PER_DB=10
# LBUG_CONNECTION_TTL_MINUTES=30.0
# LBUG_HEALTH_CHECK_INTERVAL_MINUTES=5.0

## LadybugDB Admission Control
# LBUG_ADMISSION_MEMORY_THRESHOLD=0.8
# LBUG_ADMISSION_CPU_THRESHOLD=0.8

## LadybugDB Home Directory
# LBUG_HOME=/app/data/.ladybug

## DuckDB Configuration
# DUCKDB_MAX_THREADS=4
# DUCKDB_MEMORY_LIMIT=2GB

## =============================================================================
## NEO4J-SPECIFIC CONFIGURATION (when GRAPH_BACKEND_TYPE=neo4j_*)
## =============================================================================

## Neo4j Backend Configuration
NEO4J_URI=bolt://neo4j-db:7687
NEO4J_USERNAME=neo4j
NEO4J_PASSWORD=neo4jpassword  # Retrieved from AWS Secrets Manager in prod/staging
NEO4J_ENTERPRISE=false        # Enable multi-database support (requires Enterprise license)

## Neo4j Connection Pool Configuration
# NEO4J_MAX_CONNECTION_POOL_SIZE=50
# NEO4J_CONNECTION_ACQUISITION_TIMEOUT=60
# NEO4J_MAX_CONNECTION_LIFETIME=3600

## =============================================================================
## DATABASE CONFIGURATION - POSTGRESQL
## =============================================================================

## PostgreSQL Database
POSTGRES_PASSWORD=postgres
DATABASE_URL=postgresql://postgres:${POSTGRES_PASSWORD}@pg:5432/robosystems

## Database Pool Configuration
# DATABASE_POOL_SIZE=20
# DATABASE_MAX_OVERFLOW=40
# DATABASE_POOL_TIMEOUT=30
# DATABASE_POOL_RECYCLE=3600
# DATABASE_ECHO=false

## =============================================================================
## VALKEY/REDIS CONFIGURATION
## =============================================================================

## Valkey/Redis Connection
VALKEY_AUTH_TOKEN=valkey
VALKEY_URL=redis://valkey:6379

## Cache TTLs
# CREDIT_BALANCE_CACHE_TTL=300
# CREDIT_SUMMARY_CACHE_TTL=600
# CREDIT_OPERATION_COST_CACHE_TTL=3600
# JWT_CACHE_TTL=1800
# API_KEY_CACHE_TTL=300

## =============================================================================
## PERFORMANCE AND SCALING
## =============================================================================

## Query Queue Configuration
# QUERY_QUEUE_MAX_SIZE=100
# QUERY_QUEUE_MAX_CONCURRENT=10

## Admission Control
# ADMISSION_MEMORY_THRESHOLD=0.8
# ADMISSION_CPU_THRESHOLD=0.8
# ADMISSION_QUEUE_THRESHOLD=0.9

## Load Shedding
# LOAD_SHED_START_PRESSURE=0.8
# LOAD_SHED_STOP_PRESSURE=0.6

## SSE (Server-Sent Events)
# MAX_SSE_CONNECTIONS_PER_USER=5
# SSE_QUEUE_SIZE=100
# SSE_MAX_REDIS_FAILURES=3

## MCP (Model Context Protocol)
# MCP_AUTO_LIMIT_ENABLED=true
# MCP_MAX_RESULT_ROWS=1000
# MCP_MAX_RESULT_SIZE_MB=5.0

## =============================================================================
## AWS CONFIGURATION
## =============================================================================

## AWS Bedrock Configuration (for AI agent features)
## Create dedicated IAM user with Bedrock-only permissions for security
AWS_BEDROCK_REGION=us-east-1
AWS_BEDROCK_ACCESS_KEY_ID=your-bedrock-access-key
AWS_BEDROCK_SECRET_ACCESS_KEY=your-bedrock-secret-key

## For development with LocalStack (S3, DynamoDB, etc. - NOT Bedrock):
AWS_REGION=us-east-1
AWS_ENDPOINT_URL=http://localstack:4566
AWS_ACCESS_KEY_ID=localstack-test-key
AWS_SECRET_ACCESS_KEY=localstack-test-secret

## S3 Configuration (retrieved via get_secret_value - secrets manager or env var)
# AWS_S3_BUCKET=robosystems-dev
# AWS_S3_PREFIX=robosystems
AWS_S3_ACCESS_KEY_ID=localstack-test-key       # LocalStack dummy credentials
AWS_S3_SECRET_ACCESS_KEY=localstack-test-secret   # LocalStack dummy credentials

## S3 Buckets for Specific Purposes
# SEC_RAW_BUCKET=robosystems-sec-raw
# SEC_PROCESSED_BUCKET=robosystems-sec-processed
# PUBLIC_DATA_BUCKET=robosystems-public-data
# PUBLIC_DATA_CDN_URL=

## =============================================================================
## EXTERNAL SERVICE API KEYS
## =============================================================================

## QuickBooks (for accounting integration)
INTUIT_CLIENT_ID=your-intuit-client-id-here
INTUIT_CLIENT_SECRET=your-intuit-client-secret-here
INTUIT_ENVIRONMENT=sandbox
INTUIT_REDIRECT_URI=http://localhost:8000/auth/callback
# QUICKBOOKS_SANDBOX=true

## Plaid (for banking integration)
PLAID_CLIENT_ID=your-plaid-client-id-here
PLAID_CLIENT_SECRET=your-plaid-client-secret-here
PLAID_ENVIRONMENT=sandbox

## SEC.gov Configuration
# SEC_GOV_USER_AGENT="YourCompany your-email@example.com"  # IMPORTANT: Set your own user agent for production
# SEC_MAX_CONCURRENT_DOWNLOADS=5
# SEC_VALIDATE_CIK=true
# SEC_PIPELINE_PARTIAL_TOLERANCE=true
# SEC_PIPELINE_CLEANUP_TEMP_FILES=true

## OpenFIGI (financial identifiers)
# OPENFIGI_API_KEY=

## Stripe (payment processing)
# STRIPE_SECRET_KEY=sk_test_your-stripe-secret-key-here
# STRIPE_PUBLISHABLE_KEY=pk_test_your-stripe-publishable-key-here
# STRIPE_WEBHOOK_SECRET=whsec_your-stripe-webhook-secret-here
# STRIPE_API_VERSION=2025-10-29.clover

## Cloudflare Turnstile (CAPTCHA)
# TURNSTILE_SECRET_KEY=
# TURNSTILE_SITE_KEY=

## =============================================================================
## XBRL AND ARELLE CONFIGURATION
## =============================================================================

## Arelle (XBRL processing)
# ARELLE_LOG_FILE=logToBuffer
# ARELLE_TIMEOUT=30
# ARELLE_WORK_OFFLINE=false
# ARELLE_CACHE_DIR=

## XBRL Processing
# XBRL_EXTERNALIZE_LARGE_VALUES=true
# XBRL_STANDARDIZED_FILENAMES=false
# XBRL_TYPE_PREFIXES=false
# XBRL_COLUMN_STANDARDIZATION=false

## =============================================================================
## OBSERVABILITY
## =============================================================================

## OpenTelemetry Configuration
# OTEL_SERVICE_NAME=robosystems-service
# OTEL_EXPORTER_OTLP_ENDPOINT=http://localhost:4317
# OTEL_RESOURCE_ATTRIBUTES=
# OTEL_CONSOLE_EXPORT=false
